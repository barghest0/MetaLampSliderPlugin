(()=>{"use strict";var t,e,s,i;!function(t){t.horizontal="horizontal",t.vertical="vertical"}(t||(t={})),function(t){t.min="min",t.max="max",t.step="step",t.value="value",t.isRange="isRange",t.direction="direction",t.hasFill="hasFill",t.hasTips="hasTips",t.hasScale="hasScale",t.isDecimal="isDecimal",t.decimalPlaces="decimalPlaces",t.canThumbPush="canThumbPush",t.dataFirstValue="firstValue",t.dataSecondValue="secondValue"}(e||(e={})),function(t){t.left="left",t.top="top"}(s||(s={})),function(t){t.width="width",t.height="height"}(i||(i={}));const a={min:0,max:100,step:10,value:[0],isRange:!1,direction:"horizontal",hasFill:!0,hasTips:!0,hasScale:!0,canThumbPush:!1},r=100,h=100,n=class{constructor(t={}){this.subscribers=t}subscribe(t,e){this.subscribers[t]=this.subscribers[t]||[],this.subscribers[t].push(e)}unsubscribe(t,e){this.subscribers[t]=this.subscribers[t].filter((t=>e!==t))}notify(t,e=a){this.subscribers[t].forEach((t=>{t(e)}))}getSubscribers(){return this.subscribers}},l=function(t){this.thumbs[t].style[this.view.offsetDirection]=`${this.getOffset()[t]}%`},c=function(t){const e=this.thumbs[t],s=e=>{this.handleThumbDrag(e,t)},i=e=>{e.preventDefault(),e.stopPropagation(),this.setActiveStance(t),document.addEventListener("pointermove",s)};e.addEventListener("pointerdown",i),e.addEventListener("touchstart",i),document.addEventListener("pointerup",(()=>{document.removeEventListener("pointermove",s)}))};var u,d;!function(t){t.updateThumbView="UpdateThumbView",t.updateFillView="UpdateFillView",t.updateParams="UpdateParams",t.updatePanelValues="UpdatePanelValues",t.getSliderParams="GetSliderParams"}(u||(u={})),function(t){t.updateThumb="UpdateThumb",t.updateThumbAfterTrackClick="UpdateThumbAfterTrackClick",t.updateThumbAfterScaleMarkClick="UpdateThumbAfterScaleMarkClick"}(d||(d={}));const o=function(e){const{direction:s}=this.view.getParams(),{DOMroot:i}=this.view,a=this.view.getSize(),r=s===t.horizontal?e.pageX:e.pageY,h=this.view.calculateCursorOffset(r,s,i,a);this.setCursorOffset(h),this.notify(d.updateThumb)},m=class extends n{constructor(t){super(),this.view=t,this.offset=[],this.activeStance=0,this.cursorOffset=0,this.thumbs=[],this.updateThumbStyle=l.bind(this),this.dragAndDropThumb=c.bind(this),this.handleThumbDrag=o.bind(this)}setOffset(t,e){this.offset[t]=e}getOffset(){return this.offset}setCursorOffset(t){this.cursorOffset=t}getCursorOffset(){return this.cursorOffset}setActiveStance(t){this.activeStance=t}getActiveStance(){return this.activeStance}renderThumb(t){const e=document.createElement("div");e.classList.add("slider__thumb"),e.classList.add(`js-slider__thumb-${t}`),e.classList.add(`slider__thumb-${t}`),this.thumbs.push(e),this.view.DOMroot.appendChild(e),this.updateThumbStyle(t)}},f="slider__scale-line",b="slider__scale-mark",p=[3,5,7,11],w=function(e,s,i,a){const r=function(e,s,i,a){const r=Math.round((s-e)/i+1),n=r-1,l=function(t,e){for(const s of e){const e=2*Math.round(t%s/2);if(0===e)return s;if(e>=0)return s+e}return 1}(n,p);let c=Math.max(Math.floor(n/l),1);c=c<20?Math.min(c,l):c;const u=Math.abs(s-e),d=Math.ceil(r/c),o=d-1,m=Math.floor(u/i)>d?Math.round(Math.round(u/i)/o)*i:i;return{values:new Array(d).fill(null).map(((t,i)=>{let a=e+m*i;return a=Math.min(a,s),i===o&&(a=s),Number(a.toFixed(1))})),offsets:new Array(d).fill(null).map(((e,s)=>{let i=Math.abs(m/u)*s*h;return i=Math.min(h,i),s===o&&(i=h),a===t.vertical&&(i=Math.abs(h-i)),Number(i.toFixed(1))}))}}(i,s,e,a),n=t=>e=>{this.handleScaleMarkClick(e,t)};for(let t=0;t<r.values.length;t+=1){const e=document.createElement("div");e.classList.add(b),e.classList.add(`${b}_${a}`),e.classList.add(`js-${b}_${a}`);const s=document.createElement("div");s.classList.add(f),s.classList.add(`${f}_${a}`),s.classList.add(`js-${f}_${a}`);const i=r.offsets[t],h=i;e.style[this.view.offsetDirection]=`${h}%`;const l=document.createElement("div");l.classList.add("slider__scale-number"),l.classList.add(`slider__scale-number_${a}`),l.classList.add(`js-slider__scale-number_${a}`);const c=r.values[t];l.innerHTML=c.toString(),l.addEventListener("pointerdown",n(i)),e.appendChild(s),e.appendChild(l),this.scale.appendChild(e)}},v=function(t,e){this.setCursorOffset(e),this.notify(d.updateThumbAfterScaleMarkClick)},S=class extends n{constructor(t){super(),this.view=t,this.renderScaleMarks=w.bind(this),this.handleScaleMarkClick=v.bind(this),this.cursorOffset=0}setCursorOffset(t){this.cursorOffset=t}getCursorOffset(){return this.cursorOffset}renderScale(t){const e=document.createElement("div");e.classList.add("slider__scale"),e.classList.add("js-slider__scale"),e.classList.add(`slider__scale_${t}`),this.scale=e,this.view.DOMroot.appendChild(e)}},g=function(){this.view.getParams().isRange?(this.fill.style[this.view.offsetDirection]=`${this.getState().fillOffset}%`,this.fill.style[this.view.fillDirection]=`${this.getState().fillSize}%`):this.fill.style[this.view.fillDirection]=`${this.getState().fillSize}%`},T=function(e){const{direction:s}=this.view.getParams(),{DOMroot:i}=this.view,a=this.view.getSize(),r=s===t.horizontal?e.pageX:e.pageY,h=this.view.calculateCursorOffset(r,s,i,a);this.setCursorOffset(h),this.notify(d.updateThumbAfterTrackClick)},V=function(){this.track.addEventListener("pointerdown",this.handleTrackClick)},O=class extends n{constructor(t){super(),this.view=t,this.cursorOffset=0,this.clickTrack=V.bind(this),this.handleTrackClick=T.bind(this)}setCursorOffset(t){this.cursorOffset=t}getCursorOffset(){return this.cursorOffset}renderTrack(t){const e=document.createElement("div");e.classList.add("slider__track"),e.classList.add("js-slider__track"),e.classList.add(`slider__track_${t}`),this.track=e,this.view.DOMroot.appendChild(e)}},P=function(t){this.tips[t].innerHTML=String(this.view.getValue()[t])},M=function(e){this.offsetDirection=e===t.horizontal?s.left:s.top,this.fillDirection=e===t.horizontal?i.width:i.height},k=function(e,s,i,a){return s===t.horizontal?(e-i.offsetLeft)/a*h:(e-i.offsetTop)/a*h},F=function(e,s){return s===t.horizontal?e:r-e},_=function({min:t,max:e,value:s,step:i,isRange:a,direction:r,hasFill:h,hasTips:n,hasScale:l,canThumbPush:c}){const u=s,d=function(t,e,s){let i=Math.min(Math.abs(e-s),Math.abs(t));return 0===i&&(i=1),i}(i,t,e),o=function(t,e,s){return Math.min(e-s,t)}(t,e,d);return u[0]=function(t,e,s){const i=t;return i[0]=Math.max(e,i[0]),i[0]=Math.min(s,i[0]),i[0]}(u,t,e),a&&(u[1]=function(t,e,s){const i=t;return i[1]=Math.max(e,t[1]),i[1]=Math.min(s,t[1]),i[1]=Math.max(i[0],i[1]),i[1]}(u,t,e)),{min:o,max:e,step:d,value:u,isRange:a,direction:r,hasFill:h,hasTips:n,hasScale:l,canThumbPush:c}},L=function(e){const{min:s,max:i,direction:a}=this.getParams();this.getOffset()[e]>r&&(this.setOffset(e,r),this.setValue(e,a===t.horizontal?i:s)),this.getOffset()[e]<0&&(this.setOffset(e,0),this.setValue(e,a===t.horizontal?s:i))},C=function(){const{direction:t}=this.getParams(),e=0===this.getActiveStance(),s=this.getOffset()[0],i=this.getOffset()[1],a=this.getValue()[0],r=this.getValue()[1],h=F(s,t)>F(i,t),n=F(i,t)<F(s,t);h&&e&&(this.getParams().canThumbPush?(this.setOffset(1,s),this.setValue(1,a)):(this.setOffset(0,i),this.setValue(0,r),this.setActiveStance(1))),n&&!e&&(this.getParams().canThumbPush?(this.setOffset(0,i),this.setValue(0,r)):(this.setOffset(1,s),this.setValue(1,a),this.setActiveStance(0)))},D=class extends n{constructor(t){super(),this.DOMroot=t,this.params=a,this.thumbsOffset=[],this.fillState={fillOffset:0,fillSize:0},this.size=0,this.activeStance=0,this.endsValidation=L.bind(this),this.validateParams=_.bind(this),this.validateCollision=C.bind(this)}setParams(t){this.params=this.validateParams(t),this.notify(u.getSliderParams,this.getValue(),this.getParams())}setParam(t,e){this.params[t]=e}getParams(){return this.params}setSize(t){this.size=t}getSize(){return this.size}setValue(t,e){this.params.value[t]=Number(e.toFixed(5))}getValue(){const{value:t}=this.params;return t}setOffset(t,e){this.thumbsOffset[t]=e}getOffset(){return this.thumbsOffset}setActiveStance(t){this.activeStance=t}getActiveStance(){return this.activeStance}calculateOffset(t){const{min:e,max:s,value:i,direction:a}=this.params;return F((i[t]-e)/((s-e)/h),a)}updateThumb(t,e){const{isRange:s,step:i,direction:a}=this.params,r=!Number.isInteger(i),h=Number(F(e,a).toFixed(r?5:0)),n=this.calculateStepPercent(),l=Math.round(h/n)*n;this.setActiveStance(t),this.setValidatedEndValues(h,l,n),this.endsValidation(t),s&&this.validateCollision(),this.notify(u.updateThumbView),this.params.hasFill&&this.updateFill(),this.notify(u.getSliderParams,this.getValue(),this.getParams())}updateThumbAfterClick(t){const{fillOffset:e,fillSize:s}=this.getFillState();let i=0;t>s/2+e&&(i=1),i=this.chooseCorrectStance(i),this.updateThumb(i,t)}updateFill(){this.setFillState(this.calculateFillState()),this.notify(u.updateFillView)}setFillState(t){this.fillState=t}getFillState(){return this.fillState}calculateFillState(){return{fillOffset:this.calculateFillOffset(),fillSize:this.calculateFillSize()}}setValidatedEndValues(e,s,i){if(e<r-(r-s)/2)this.setValue(this.activeStance,this.calculateValue(s,i)),this.setOffset(this.activeStance,this.calculateOffset(this.activeStance));else{this.setValue(this.activeStance,this.params.max);const e=this.params.direction===t.horizontal?r:0;this.setOffset(this.activeStance,e)}}chooseCorrectStance(e){const{isRange:s,direction:i}=this.getParams();return s?i===t.vertical?Number(!e):e:0}calculateFillSize(){const{isRange:t,direction:e}=this.params;return t?this.calculateBasedOnDirection(this.thumbsOffset[0],this.thumbsOffset[1]):F(this.thumbsOffset[0],e)}calculateBasedOnDirection(e,s){const{direction:i}=this.getParams();return i===t.horizontal?s-e:e-s}calculateFillOffset(){const{isRange:e,direction:s}=this.params;return e?s===t.horizontal?this.thumbsOffset[0]:this.thumbsOffset[1]:0}calculateStepPercent(){const{max:t,min:e,step:s}=this.params;return h/((t-e)/s)}calculateValue(t,e){const{step:s,min:i}=this.params;return t/e*s+i}},z=function(){const{direction:e}=this.getParams(),s=e===t.horizontal?t.vertical:t.horizontal;this.DOMroot.classList.remove(`slider_${s}`),this.DOMroot.classList.remove(`js-slider_${s}`),this.DOMparent.classList.remove(`slider-parent_${s}`),this.DOMroot.innerHTML=""},A=function(){$(this.DOMroot.classList[0]).off()},x=function(){return this.view.thumbView.subscribe(d.updateThumb,this.updateThumb),this.view.trackView.subscribe(d.updateThumbAfterTrackClick,this.updateThumbAfterTrackClick),this.view.scaleView.subscribe(d.updateThumbAfterScaleMarkClick,this.updateThumbAfterScaleMarkClick),this.model.subscribe(u.getSliderParams,this.getSliderParams),this.model.subscribe(u.updateThumbView,this.updateThumbView),this.model.getParams().hasFill&&this.model.subscribe(u.updateFillView,this.updateFillView),this.model.getParams().hasTips&&this.model.subscribe(u.updateThumbView,this.updateTipView),this},y=function(){const{isRange:t}=this.model.getParams();this.view.tipView.updateTipText(0),t&&this.view.tipView.updateTipText(1)},E=function(){const t=this.model.getFillState();this.view.fillView.setState(t),this.view.fillView.updateFillStyle()},R=function(){const{isRange:t}=this.model.getParams();return this.view.thumbView.dragAndDropThumb(0),this.view.trackView.clickTrack(),t&&this.view.thumbView.dragAndDropThumb(1),this},N=function(){const t=this.view.trackView.getCursorOffset();this.model.updateThumbAfterClick(t)},j=function(){const t=this.view.thumbView.getActiveStance(),e=this.view.thumbView.getCursorOffset();this.model.updateThumb(t,e)},B=function(){const t=this.model.getActiveStance(),{isRange:e}=this.model.getParams(),s=this.model.getOffset()[0],i=this.model.getOffset()[1],a=this.model.getValue()[0],r=this.model.getValue()[1];this.view.thumbView.setActiveStance(t),this.view.thumbView.setOffset(0,s),this.view.setValue(0,a),this.view.thumbView.updateThumbStyle(0),e&&(this.view.setValue(1,r),this.view.thumbView.setOffset(1,i),this.view.thumbView.updateThumbStyle(1))},U=function(){return this.view.thumbView.unsubscribe(d.updateThumb,this.updateThumb),this.view.trackView.unsubscribe(d.updateThumbAfterTrackClick,this.updateThumbAfterTrackClick),this.view.scaleView.unsubscribe(d.updateThumbAfterScaleMarkClick,this.updateThumbAfterTrackClick),this.model.unsubscribe(u.getSliderParams,this.getSliderParams),this.model.unsubscribe(u.updateThumbView,this.updateThumbView),this.getParams().hasFill||this.model.unsubscribe(u.updateFillView,this.updateFillView),this.getParams().hasTips||this.model.unsubscribe(u.updateThumbView,this.updateTipView),this},H=function(t){return t},I=function(){const t=this.view.scaleView.getCursorOffset();this.model.updateThumbAfterClick(t)};function W({min:t,max:e,value:s,step:i,isRange:r,direction:h,hasFill:n,hasTips:l,hasScale:c,canThumbPush:u}){const d=t??a.min,o=e??a.max,m=i??a.step,f=r??a.isRange,b=h??a.direction,p=n??a.hasFill,w=l??a.hasTips,v=c??a.hasScale,S=u??a.canThumbPush;let g=s??a.value;return Array.isArray(g)||(g=[g]),r&&1===g.length&&g.push(g[0]),{min:d,max:o,value:g,step:m,isRange:f,direction:b,hasFill:p,hasTips:w,hasScale:v,canThumbPush:S}}const X={getContainer:t=>t.getContainer(),getParent:t=>t.getParent(),getSliderInstance:t=>t,getParams:t=>t.getParams(),updateParams(t,e){t.updateParams(e)},subscribe(t,e){t.subscribe(e)},unsubscribe(t){t.unsubscribe()}},Y=[];let q=0;function G(r,h,n){const l=W(r),c=function(t,s){let i;const a=t.data(e.dataFirstValue)&&t.data(e.dataSecondValue),r=t.data(e.dataFirstValue)||t.data(e.dataSecondValue);i=a?[Number(t.data(e.dataFirstValue)),Number(t.data(e.dataSecondValue))]:r?[Number(t.data(e.dataFirstValue))]||0:s.value;const h=Number(t.data(e.min))||s.min,n=Number(t.data(e.max))||s.max,l=i,c=Number(t.data(e.decimalPlaces))||s.decimalPlaces,u=Number(t.data(e.step))||s.step,d=Boolean(t.data(e.isRange))||s.isRange,o=t.data(e.direction)||s.direction,m=Boolean(t.data(e.hasFill))||s.hasFill,f=Boolean(t.data(e.hasTips))||s.hasTips,b=Boolean(t.data(e.hasScale))||s.hasScale,p=Boolean(t.data(e.isDecimal))||s.isDecimal;return{min:h,max:n,value:l,decimalPlaces:c,step:u,isRange:d,direction:o,hasFill:m,hasTips:f,canThumbPush:Boolean(t.data(e.canThumbPush))||s.canThumbPush,hasScale:b,isDecimal:p}}($(n),l);return n.dataset.sliderInstance=h.toString(),new class{constructor(e,r){this.params=r,this.DOMroot=e,this.DOMparent=e.parentElement,this.presenter=new class{constructor(t,e,r){this.DOMroot=e,this.DOMparent=r,this.model=new D(this.DOMroot),this.view=new class{constructor(t){this.DOMroot=t,this.thumbView=new m(this),this.trackView=new O(this),this.scaleView=new S(this),this.fillView=new class{constructor(t){this.view=t,this.state={fillOffset:0,fillSize:0},this.updateFillStyle=g.bind(this)}setState({fillOffset:t,fillSize:e}){this.state.fillOffset=t,this.state.fillSize=e}getState(){return this.state}renderFill(t){const e=document.createElement("div");e.classList.add("slider__fill"),e.classList.add("js-slider__fill"),e.classList.add(`slider__fill_${t}`),this.fill=e,this.view.DOMroot.appendChild(e),this.updateFillStyle()}}(this),this.tipView=new class{constructor(t){this.view=t,this.tips=[],this.updateTipText=P.bind(this)}renderTip(t,e){const s=document.createElement("div");s.classList.add("slider__tip"),s.classList.add(`js-slider__tip-${t}`),s.classList.add(`slider__tip-${t}`),s.classList.add(`slider__tip_${e}`),this.tips.push(s),this.view.thumbView.thumbs[t].appendChild(s),this.updateTipText(t)}}(this),this.params=a,this.size=0,this.offsetDirection=s.left,this.fillDirection=i.width,this.prepareDirectionForInteraction=M.bind(this),this.calculateCursorOffset=k.bind(this)}setParams(t){this.params=t}setParam(t,e){this.params[t]=e}setSize(t){this.size=t}getParams(){return this.params}getSize(){return this.size}setValue(t,e){this.params.value[t]=e}getValue(){return this.params.value}}(this.DOMroot),this.params=t,this.clearHTML=z.bind(this),this.removeListeners=A.bind(this),this.subscribe=x.bind(this),this.unsubscribe=U.bind(this),this.updateThumbAfterTrackClick=N.bind(this),this.updateThumbAfterScaleMarkClick=I.bind(this),this.updateThumb=j.bind(this),this.updateThumbView=B.bind(this),this.updateTipView=y.bind(this),this.updateFillView=E.bind(this),this.addListeners=R.bind(this),this.getSliderParams=H.bind(this)}init(){this.subscribe(),this.setParams(this.params),this.createSlider(),this.addListeners()}rerender(t){this.setParams(t),this.view.thumbView.thumbs=[],this.view.tipView.tips=[],this.unsubscribe(),this.clearHTML(),this.removeListeners(),this.subscribe(),this.createSlider(),this.addListeners()}setParams(t){this.params=t}getParams(){return this.params}createSlider(){this.addSliderClasses(this.params.direction).setModelState().setViewState().setSubViewsState().renderSlider()}setModelState(){this.model.setParams(this.params);const e=this.model.getParams().direction===t.horizontal?this.DOMroot.offsetWidth:this.DOMroot.offsetHeight;return this.model.setSize(e),this.model.getParams().value.forEach(((t,e)=>{this.model.setOffset(e,this.model.calculateOffset(e))})),this.model.setFillState(this.model.calculateFillState()),this}addSliderClasses(t){return this.DOMroot.classList.add("slider"),this.DOMroot.classList.add("js-slider"),this.DOMroot.classList.add(`slider_${t}`),this.DOMroot.classList.add(`js-slider_${t}`),this.DOMparent.classList.add(`slider-parent_${t}`),this}setViewState(){return this.view.setParams(this.model.getParams()),this.view.setSize(this.model.getSize()),this.view.prepareDirectionForInteraction(this.model.getParams().direction),this}setSubViewsState(){const{hasFill:t}=this.model.getParams(),e=this.model.getValue(),s=this.model.getFillState();return e.forEach(((t,e)=>{this.setThumbViewState(e)})),t&&this.setFillViewState(s),this}setThumbViewState(t){const e=this.model.getOffset()[t];this.view.thumbView.setOffset(t,e)}setFillViewState(t){this.view.fillView.setState(t)}renderSlider(){const{direction:t,hasFill:e,hasScale:s,hasTips:i,isRange:a}=this.model.getParams();this.renderTrack(t),this.renderThumb(0),i&&this.renderTip(0,t),s&&this.renderScale(t),e&&this.renderFill(t),a&&(this.renderThumb(1),i&&this.renderTip(1,t))}renderTrack(t){this.view.trackView.renderTrack(t)}renderThumb(t){this.view.thumbView.renderThumb(t)}renderTip(t,e){this.view.tipView.renderTip(t,e)}renderFill(t){this.view.fillView.renderFill(t)}renderScale(t){const{step:e,max:s,min:i}=this.model.getParams();this.view.scaleView.renderScale(t),this.view.scaleView.renderScaleMarks(e,s,i,t)}}(this.params,this.DOMroot,this.DOMparent),this.init()}getParams(){return this.params}getContainer(){return this.DOMroot}getParent(){return this.DOMparent}unsubscribe(){this.presenter.unsubscribe()}updateParams(t){this.presenter.rerender(W(t)),this.params=this.presenter.model.getParams()}subscribe(t){this.presenter.model.subscribe(u.getSliderParams,t)}init(){this.presenter.init(),this.attachResizeListener()}handleWindowResize(){this.presenter.rerender(this.params)}attachResizeListener(){window.addEventListener("resize",this.handleWindowResize.bind(this))}}(n,c)}$.fn.extend({slider:function(...t){const[e,s]=t,i=e&&"string"==typeof e,a=!i||"object"==typeof e;if(i){const t=Y[this.data("sliderInstance")];return X[e](t,s)}return a?this.each(((t,s)=>{Y.push(G(e||{},q,s)),q+=1})):null}}),window.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll('[data-slider="true"]').forEach((t=>{$(t).slider()}))}))})();